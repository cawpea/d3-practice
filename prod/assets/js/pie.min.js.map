{"version":3,"sources":["assets/js/pie.js"],"names":["drawPie","fileName","year","d3","csv","error","data","dataSet","i","push","render","svgWidth","svgHeight","pie","arc","innerRadius","outerRadius","pieElements","select","selectAll","enter","append","attr","style","d","transition","duration","delay","ease","easeLinear","attrTween","interpolate","startAngle","endAngle","t","text","sum","centroid","value","on","remove","this"],"mappings":"AAQA,QAASA,SAAQC,EAAUC,GAEzBC,GAAGC,IAAIH,EAAU,SAASI,EAAOC,GAC/B,GAAIC,KACJ,KAAI,GAAIC,KAAKF,GAAK,GAChBC,EAAQE,KAAKH,EAAK,GAAGE,GAEvBE,QAAOH,KAIX,QAASG,QAAOH,GACd,GAAII,GAAW,IACXC,EAAY,IAGZC,EAAMV,GAAGU,MAGTC,EAAMX,GAAGW,MAAMC,YAAY,IAAIC,YAAY,KAG3CC,EAAcd,GAAGe,OAAO,YACzBC,UAAU,KACVb,KAAKO,EAAIN,IACTa,QACAC,OAAO,KACPC,KAAK,YAAa,aAAeX,EAAW,EAAI,KAAOC,EAAY,EAAI,IAG1EK,GACGI,OAAO,QACPC,KAAK,QAAS,OACdC,MAAM,OAAQ,SAASC,EAAGhB,GACzB,OAAQ,MAAO,SAAU,SAAU,OAAQ,SAASA,KAErDiB,aACAC,SAAS,KACTC,MAAM,SAASH,EAAGhB,GACjB,MAAW,KAAJA,IAERoB,KAAKzB,GAAG0B,YACRC,UAAU,IAAK,SAASN,EAAGhB,GAC1B,GAAIuB,GAAc5B,GAAG4B,aACjBC,WAAYR,EAAEQ,WAAYC,SAAUT,EAAEQ,aACtCA,WAAYR,EAAEQ,WAAYC,SAAUT,EAAES,UAE1C,OAAO,UAASC,GACd,MAAOpB,GAAIiB,EAAYG,MAKV/B,IAAGe,OAAO,YAC1BG,OAAO,QACPC,KAAK,QAAS,SACdA,KAAK,YAAa,aAAeX,EAAW,EAAI,MAAQC,EAAY,EAAI,GAAK,KAC7EuB,KAAK,MAAQhC,GAAGiC,IAAI7B,GAGvBU,GACGI,OAAO,QACPC,KAAK,QAAS,UACdA,KAAK,YAAa,SAASE,EAAGhB,GAC7B,MAAO,aAAeM,EAAIuB,SAASb,GAAK,MAEzCW,KAAK,SAASX,EAAGhB,GAChB,MAAOgB,GAAEc,QA3EftC,QAAQ,wBAGRG,GAAGe,OAAO,SAASqB,GAAG,SAAU,WAC9BpC,GAAGe,OAAO,YAAYC,UAAU,KAAKqB,SACrCxC,QAAQ,SAAWyC,KAAKH,MAAQ,OAAQG,KAAKH","file":"pie.min.js","sourcesContent":["drawPie('/data/mydata2008.csv');\n\n//セレクトメニューが選択された場合の処理\nd3.select('#year').on('change', function() {\n  d3.select('#myGraph').selectAll('*').remove();\n  drawPie('mydata' + this.value + '.csv', this.value);\n});\n\nfunction drawPie(fileName, year) {\n  //データセットはCSVファイル\n  d3.csv(fileName, function(error, data) {\n    var dataSet = [];\n    for(var i in data[0]) {\n      dataSet.push(data[0][i]);\n    }\n    render(dataSet);\n  });\n}\n\nfunction render(dataSet) {\n  var svgWidth = 320;\n  var svgHeight = 240;\n\n  //円グラフの座標値を計算するメソッド\n  var pie = d3.pie();\n\n  //円グラフの外径、内径を設定\n  var arc = d3.arc().innerRadius(30).outerRadius(100);\n\n  //円グラフを描画\n  var pieElements = d3.select('#myGraph')\n    .selectAll('g')\n    .data(pie(dataSet))\n    .enter()\n    .append('g')\n    .attr('transform', 'translate(' + svgWidth / 2 + ', ' + svgHeight / 2 + ')');\n\n  //データの追加\n  pieElements\n    .append('path')\n    .attr('class', 'pie')\n    .style('fill', function(d, i) {\n      return ['red', 'orange', 'yellow', 'cyan', 'green'][i];\n    })\n    .transition()\n    .duration(1000)\n    .delay(function(d, i) {\n      return i * 1000;\n    })\n    .ease(d3.easeLinear)\n    .attrTween('d', function(d, i) { //補間処理をする\n      var interpolate = d3.interpolate(\n        { startAngle: d.startAngle, endAngle: d.startAngle }, //各部分の開始角度\n        { startAngle: d.startAngle, endAngle: d.endAngle } //各部分の終了角度\n      );\n      return function(t) {\n        return arc(interpolate(t));\n      }\n    });\n\n  //合計の数と文字の表示\n  var textElements = d3.select('#myGraph')\n    .append('text')\n    .attr('class', 'total')\n    .attr('transform', 'translate(' + svgWidth / 2 + ', ' + (svgHeight / 2 + 5) + ')')\n    .text('合計:' + d3.sum(dataSet));\n\n  //数値を円弧の中に表示\n  pieElements\n    .append('text')\n    .attr('class', 'pieNum')\n    .attr('transform', function(d, i) {\n      return 'translate(' + arc.centroid(d) + ')';\n    })\n    .text(function(d, i) {\n      return d.value;\n    })\n}\n"],"sourceRoot":"SORUCE_DIR"}