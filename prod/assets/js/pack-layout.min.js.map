{"version":3,"sources":["assets/js/pack-layout.js"],"names":["updatePackLayout","dataSet","year","data","d3","schemeCategory10","hierarchy","sum","d","sort","a","b","value","console","log","packElements","select","selectAll","pack","descendants","transition","duration","attr","i","x","y","circles","r","drawPackLayout","color","size","svgWidth","svgHeight","enter","append","depth","style","texts","text","name","allData","json","error","on","this"],"mappings":"AAQA,QAASA,kBAAiBC,EAASC,GAEjC,GAEIC,IAFQC,GAAGC,iBAEJD,GAAGE,UAAUL,GACrBM,IAAI,SAASC,GACZ,MAAOA,GAAEN,KAEVO,KAAK,SAASC,EAAGC,GAChB,MAAOA,GAAEC,MAAQF,EAAEE,QAGvBC,SAAQC,IAAIX,GAEZY,aAAeX,GAAGY,OAAO,YACtBC,UAAU,KACVd,KAAMe,KAAMf,GAAOgB,eACnBC,aACAC,SAAS,KACTC,KAAK,YAAa,SAASd,EAAGe,GAC7B,MAAO,aAAef,EAAEgB,EAAI,KAAOhB,EAAEiB,EAAI,MAG7CC,QAAUX,aAAaE,UAAU,UAC9BK,KAAK,IAAK,GACVF,aACAC,SAAS,KACTC,KAAK,IAAK,SAASd,GAClB,MAAOA,GAAEmB,IAIf,QAASC,gBAAe3B,EAASC,GAE/B,GAAI2B,GAAQzB,GAAGC,gBAGfa,MAAOd,GAAGc,OACPY,MAAOC,SAAUC,WAEpB,IAAI7B,GAAOC,GAAGE,UAAUL,GACrBM,IAAI,SAASC,GACZ,MAAOA,GAAEN,KAEVO,KAAK,SAASC,EAAGC,GAChB,MAAOA,GAAEC,MAAQF,EAAEE,OAGvBC,SAAQC,IAAIX,GAEZY,aAAeX,GAAGY,OAAO,YACtBC,UAAU,KACVd,KAAMe,KAAKf,GAAMgB,eACjBc,QACAC,OAAO,KACPZ,KAAK,YAAa,SAASd,EAAGe,GAC7B,MAAO,aAAef,EAAEgB,EAAI,KAAOhB,EAAEiB,EAAI,MAG7CC,QAAUX,aAAamB,OAAO,UAC3BZ,KAAK,IAAK,GACVF,aACAC,SAAS,SAASb,EAAGe,GACpB,MAAiB,KAAVf,EAAE2B,MAAe,MAEzBb,KAAK,IAAK,SAASd,GAClB,MAAOA,GAAEmB,IAEVS,MAAM,OAAQ,SAAS5B,EAAGe,GACzB,MAAOM,GAAMN,KAGjBc,MAAQtB,aAAamB,OAAO,QACzBE,MAAM,UAAW,GACjBhB,aACAC,SAAS,KACTe,MAAM,UAAW,GACjBE,KAAK,SAAS9B,EAAGe,GAChB,MAAe,KAAZf,EAAE2B,MACI3B,EAAEL,KAAKoC,KAET,OAzFb,GAAIR,UAAW,IACXC,UAAY,IACZQ,QACAtB,KACAH,aACAW,QACAW,OAuFH,WACCjC,GAAGqC,KAAK,yBAA0B,SAASC,EAAOvC,GAChDqC,QAAUrC,EACVyB,eAAgBY,QAAS,cAE3BpC,GAAGa,UAAU,SAAS0B,GAAG,QAAS,WAChCzC,KAAOE,GAAGY,OAAO4B,MAAMtB,KAAK,aAC5BtB,iBAAkBwC,QAAStC","file":"pack-layout.min.js","sourcesContent":["var svgWidth = 320;\nvar svgHeight = 320;\nvar allData;\nvar pack;\nvar packElements;\nvar circles;\nvar texts;\n\nfunction updatePackLayout(dataSet, year) {\n  // カラーを準備\n  var color = d3.schemeCategory10;\n\n  var data = d3.hierarchy(dataSet)\n    .sum(function(d) { \n      return d[year]; \n    })\n    .sort(function(a, b) { \n      return b.value - a.value; \n    });\n\n  console.log(data);\n\n  packElements = d3.select('#myGraph')\n    .selectAll('g')\n    .data( pack( data ).descendants() )\n    .transition()\n    .duration(500)\n    .attr('transform', function(d, i) {\n      return 'translate(' + d.x + ', ' + d.y + ')'\n    });\n\n  circles = packElements.selectAll('circle')\n    .attr('r', 0)\n    .transition()\n    .duration(500)\n    .attr('r', function(d) {\n      return d.r;\n    })\n}\n\nfunction drawPackLayout(dataSet, year) {\n  // カラーを準備\n  var color = d3.schemeCategory10;\n\n  //パックレイアウト\n  pack = d3.pack()\n    .size([ svgWidth, svgHeight ]);\n\n  var data = d3.hierarchy(dataSet)\n    .sum(function(d) { \n      return d[year]; \n    })\n    .sort(function(a, b) { \n      return b.value - a.value; \n    });\n\n  console.log(data);\n\n  packElements = d3.select('#myGraph')\n    .selectAll('g')\n    .data( pack(data).descendants() )\n    .enter()\n    .append('g')\n    .attr('transform', function(d, i) {\n      return 'translate(' + d.x + ', ' + d.y + ')'\n    });\n\n  circles = packElements.append('circle')\n    .attr('r', 0)\n    .transition()\n    .duration(function(d, i) {\n      return d.depth * 1000 + 500;\n    })\n    .attr('r', function(d) {\n      return d.r;\n    })\n    .style('fill', function(d, i) {\n      return color[i];\n    });\n\n  texts = packElements.append('text')\n    .style('opacity', 0)\n    .transition()\n    .duration(3000)\n    .style('opacity', 1.0)\n    .text(function(d, i) {\n      if(d.depth === 1) {\n        return d.data.name;\n      } \n      return null;\n    });\n} \n\n(function() {\n  d3.json('/data/pack-layout.json', function(error, data) {\n    allData = data;\n    drawPackLayout( allData, 'year2000');\n  });\n  d3.selectAll('input').on('click', function() {\n    year = d3.select(this).attr('data-year');\n    updatePackLayout( allData, year );\n  });\n}());"],"sourceRoot":"SORUCE_DIR"}