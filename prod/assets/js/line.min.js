function render(){year=d3.extent(data,function(t){return t.year}),startYear=year[0],currentYear=2e3,margin=svgWidth/(rangeYear-1),this.drawGraphs()}function drawGraphs(){pickupData(data,currentYear-startYear),drawGraph(dataSet,"item1","itemA"),drawGraph(dataSet,"item2","itemB"),drawGraph(dataSet,"item3","itemC"),drawScale()}function drawGraph(t,a,e){var r=d3.line().x(function(t,a){return offsetX+a*margin}).y(function(t,e){return svgHeight-t[a]*scale-offsetY}).curve(d3.curveNatural);d3.select("#myGraph").append("path").attr("class","line "+e).attr("d",r(t))}function drawScale(){var t=d3.scaleLinear().domain([0,100]).range([100*scale,0]);d3.select("#myGraph").append("g").attr("class","axis").attr("transform","translate("+offsetX+", "+(100-100*(scale-1)+offsetY)+")").call(d3.axisLeft(t)),d3.select("#myGraph").append("rect").attr("class","axis_x").attr("width",svgWidth).attr("height",1).attr("transform","translate("+offsetX+", "+(svgHeight-offsetY)+")");var a=d3.scaleTime().domain([new Date(currentYear+"/1/1"),new Date(currentYear+rangeYear-1+"/1/1")]).range([0,svgWidth]);d3.select("#myGraph").append("g").attr("class","axis").attr("transform","translate("+offsetX+", "+(svgHeight-offsetY)+")").call(d3.axisBottom(a).ticks(10).tickFormat(function(t,a){var e=d3.timeFormat("%Y年%m月");return e(t)})).selectAll("text").attr("transform","rotate(90)").attr("dx","0.7em").attr("dy","-0.4em").style("text-anchor","start")}function pickupData(t,a){dataSet=[];for(var e=0;e<rangeYear;e++)dataSet[e]=t[a+e],d3.select("#myGraph").selectAll("*").remove()}var dataSet=[],svgEle=document.getElementById("myGraph"),svgWidth=window.getComputedStyle(svgEle,null).getPropertyValue("width"),svgHeight=window.getComputedStyle(svgEle,null).getPropertyValue("height");svgWidth=parseFloat(svgWidth)-60,svgHeight=parseFloat(svgHeight)-60;var offsetX=30,offsetY=20,scale=2,rangeYear=10,year,startYear,currentYear,margin;!function(){d3.json("/data/mydata.json",function(t,a){data=a,render()}),d3.select("#prev").on("click",function(){currentYear>year[0]&&(currentYear-=1),drawGraphs()}),d3.select("#next").on("click",function(){currentYear<=year[1]-rangeYear&&(currentYear+=1),drawGraphs()})}();
//# sourceMappingURL=line.min.js.map
